<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="theme-color" content="#635bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Æ–Ω–∏—Ç-–≠–∫–æ–Ω–æ–º–∏–∫–∏</title>
    <link rel="stylesheet" href="styles.css?v=2.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-calculator"></i> –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Æ–Ω–∏—Ç-–≠–∫–æ–Ω–æ–º–∏–∫–∏</h1>
            <p>‚ú® –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ Wildberries</p>
            <div class="header-buttons">
                <div class="author-info">
                    <p><i class="fab fa-telegram"></i> –ê–≤—Ç–æ—Ä: <a href="https://t.me/karim_wbmanagerr" target="_blank">@karim_wbmanagerr</a></p>
                </div>
            </div>
        </header>

        <div class="calculator-grid">
            <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö -->
            <div class="input-section">
                <h2><i class="fas fa-edit"></i> –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö</h2>
                
                <!-- –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ - –í–ê–ñ–ù–û: —Ä–∞–∑–º–µ—â–∞–µ–º –ø–µ—Ä–≤—ã–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ -->
                <div class="form-group" style="margin-bottom: 24px; padding: 16px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.05) 100%); border-radius: 16px; border: 2px solid rgba(99, 102, 241, 0.2);">
                    <label for="product-search" style="font-weight: 700; color: #6366f1; margin-bottom: 12px; display: block;">
                        <i class="fas fa-search" style="margin-right: 8px;"></i> üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ –∏ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
                    </label>
                    <div class="search-container">
                        <input type="text" id="product-search" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞..." autocomplete="off" style="width: 100%; padding: 16px 20px; border: 2px solid rgba(99, 102, 241, 0.25); border-radius: 12px; font-size: 16px; font-weight: 500; background: white; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);">
                        <div id="product-suggestions" class="suggestions-list"></div>
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 12px;">
                        <button type="button" class="add-product-btn" onclick="showAddProductModal()" style="flex: 1; padding: 10px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 0.875rem;">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        <button type="button" class="import-products-btn" onclick="showImportModal()" style="flex: 1; padding: 10px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 0.875rem;">
                            <i class="fas fa-upload"></i> –ò–º–ø–æ—Ä—Ç
                        </button>
                    </div>
                    <small style="display: block; margin-top: 12px; color: #6366f1; font-weight: 500;">
                        üí° –ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞ ‚Üí –∫–æ–º–∏—Å—Å–∏—è –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="units-sold">–ü—Ä–æ–¥–∞–Ω–æ –µ–¥–∏–Ω–∏—Ü</label>
                    <input type="number" id="units-sold" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="0">
                </div>

                <div class="form-group">
                    <label for="logistics">–õ–æ–≥–∏—Å—Ç–∏–∫–∞ –í–ë (—Ä—É–±.)</label>
                    <input type="number" id="logistics" placeholder="0.00" step="0.01" min="0">
                    <small>–ó–∞–≤–∏—Å–∏—Ç –æ—Ç –§–ë–û/–§–ë–°, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–æ–≤–∞—Ä–∞</small>
                </div>

                <div class="form-group">
                    <label for="fulfillment">–§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç (—Ä—É–±.)</label>
                    <input type="number" id="fulfillment" placeholder="0.00" step="0.01" min="0">
                </div>

                <div class="form-group">
                    <label for="paid-acceptance">–ü–ª–∞—Ç–Ω–∞—è –ø—Ä–∏–µ–º–∫–∞ (—Ä—É–±.)</label>
                    <input type="number" id="paid-acceptance" placeholder="0.00" step="0.01" min="0">
                    <small>–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–ª–∞—Ç–Ω–æ–π –ø—Ä–∏–µ–º–∫–∏ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ –í–ë</small>
                </div>

                <div class="form-group">
                    <label for="wb-commission">–ö–æ–º–∏—Å—Å–∏—è –í–ë (%)</label>
                    <input type="number" id="wb-commission" placeholder="15.5" step="0.1" min="0" max="100">
                    <small style="color: #6366f1; font-weight: 600;">‚ú® –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –ø–æ–∏—Å–∫–∞ –≤—ã—à–µ</small>
                </div>

                <div class="form-group">
                    <label for="storage-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è –í–ë (—Ä—É–±.)</label>
                    <input type="number" id="storage-cost" placeholder="0.00" step="0.01" min="0">
                </div>

                <div class="form-group">
                    <label for="advertising">–†–µ–∫–ª–∞–º–∞ (—Ä—É–±.)</label>
                    <input type="number" id="advertising" placeholder="0.00" step="0.01" min="0">
                </div>

                <div class="form-group">
                    <label for="purchase-price">–ó–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ (—Ä—É–±.)</label>
                    <input type="number" id="purchase-price" placeholder="0.00" step="0.01" min="0">
                </div>

                <div class="form-group">
                    <label for="selling-price">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (—Ä—É–±.)</label>
                    <input type="number" id="selling-price" placeholder="0.00" step="0.01" min="0">
                    <small>–†–æ–∑–Ω–∏—á–Ω–∞—è —Ü–µ–Ω–∞ –Ω–∞ –í–ë</small>
                </div>

                <div class="form-group">
                    <label for="redemption-rate">–ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞ (%)</label>
                    <input type="number" id="redemption-rate" placeholder="85" step="0.1" min="0" max="100">
                </div>

                <button class="calculate-btn" onclick="calculateEconomics()">
                    <i class="fas fa-calculator"></i> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
                </button>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <div class="results-section">
                <h2><i class="fas fa-chart-line"></i> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–æ–≤</h2>
                
                <div class="results-grid">
                    <div class="result-card">
                        <h3>–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
                        <div class="result-item">
                            <span>–≠–∫–≤–∞–π—Ä–∏–Ω–≥:</span>
                            <span class="value">2.5%</span>
                        </div>
                    </div>

                    <div class="result-card">
                        <h3>–ù–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ</h3>
                        <div class="result-item">
                            <span>5%:</span>
                            <span class="value" id="tax-5">0.00 —Ä—É–±.</span>
                        </div>
                        <div class="result-item">
                            <span>7%:</span>
                            <span class="value" id="tax-7">0.00 —Ä—É–±.</span>
                        </div>
                        <div class="result-item">
                            <span>2%:</span>
                            <span class="value" id="tax-2">0.00 —Ä—É–±.</span>
                        </div>
                    </div>

                    <div class="result-card profit-card">
                        <h3>–ü—Ä–∏–±—ã–ª—å</h3>
                        <div class="result-item">
                            <span>–ü—Ä–∏ 5%:</span>
                            <span class="value profit" id="profit-5">0.00 —Ä—É–±.</span>
                        </div>
                        <div class="result-item">
                            <span>–ü—Ä–∏ 7%:</span>
                            <span class="value profit" id="profit-7">0.00 —Ä—É–±.</span>
                        </div>
                        <div class="result-item">
                            <span>–ü—Ä–∏ 2%:</span>
                            <span class="value profit" id="profit-2">0.00 —Ä—É–±.</span>
                        </div>
                    </div>

                    <div class="result-card metrics-card">
                        <h3>–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
                        <div class="result-item">
                            <span>–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å:</span>
                            <span class="value" id="margin">0.00%</span>
                        </div>
                        <div class="result-item">
                            <span>–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å:</span>
                            <span class="value" id="profitability">0.00%</span>
                        </div>
                    </div>
                </div>

                <div class="summary-card">
                    <h3><i class="fas fa-info-circle"></i> –°–≤–æ–¥–∫–∞ –ø–æ –µ–¥–∏–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞</h3>
                    <div id="unit-summary">
                        <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞</p>
                    </div>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>&copy; 2025 –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Æ–Ω–∏—Ç-–≠–∫–æ–Ω–æ–º–∏–∫–∏ –¥–ª—è Wildberries</p>
            <p>–°–æ–∑–¥–∞–Ω–æ <a href="https://t.me/karim_wbmanagerr" target="_blank">@karim_wbmanagerr</a> –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö</p>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
    <div id="import-products-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-upload"></i> –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤</h3>
                <button class="modal-close" onclick="hideImportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="import-format">–§–æ—Ä–º–∞—Ç –∏–º–ø–æ—Ä—Ç–∞</label>
                    <select id="import-format" style="width: 100%; padding: 16px 20px; border: 2px solid rgba(99, 102, 241, 0.15); border-radius: 14px; font-size: 16px; background: rgba(255, 255, 255, 0.95); margin-bottom: 16px;">
                        <option value="json">JSON (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                        <option value="csv">CSV (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="import-data">–í—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤</label>
                    <textarea id="import-data" rows="10" placeholder='JSON —Ñ–æ—Ä–º–∞—Ç:&#10;[&#10;  {"name": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞", "commission": 15.5, "warehouse": "–§–ë–û"},&#10;  {"name": "–î—Ä—É–≥–æ–π —Ç–æ–≤–∞—Ä", "commission": 18.0, "warehouse": "–§–ë–û"}&#10;]&#10;&#10;CSV —Ñ–æ—Ä–º–∞—Ç:&#10;–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞,15.5,–§–ë–û&#10;–î—Ä—É–≥–æ–π —Ç–æ–≤–∞—Ä,18.0,–§–ë–û' style="width: 100%; padding: 16px 20px; border: 2px solid rgba(99, 102, 241, 0.15); border-radius: 14px; font-size: 14px; font-family: 'Courier New', monospace; resize: vertical; background: rgba(255, 255, 255, 0.95);"></textarea>
                    <small>–í—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ</small>
                </div>
                <div class="form-group">
                    <label style="cursor: pointer; display: flex; align-items: center; gap: 8px;">
                        <input type="file" id="import-file" accept=".json,.csv,.txt,.xlsx,.xls" style="display: none;" onchange="handleFileImport(event)">
                        <span style="padding: 10px 16px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); border-radius: 10px; border: 2px dashed rgba(99, 102, 241, 0.3); cursor: pointer; flex: 1; text-align: center; transition: all 0.3s;">
                            <i class="fas fa-file-upload"></i> –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª (JSON, CSV, Excel)
                        </span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn-cancel" onclick="hideImportModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn-save" onclick="importProducts()">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
    <div id="add-product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
                <button class="modal-close" onclick="hideAddProductModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="new-product-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" id="new-product-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö—Ä–æ—Å—Å–æ–≤–∫–∏ Nike">
                </div>
                <div class="form-group">
                    <label for="new-product-commission">–ö–æ–º–∏—Å—Å–∏—è –í–ë (%)</label>
                    <input type="number" id="new-product-commission" placeholder="15.5" step="0.1" min="0" max="100">
                </div>
                <div class="form-group">
                    <label for="new-product-warehouse">–°–∫–ª–∞–¥ –í–ë</label>
                    <select id="new-product-warehouse" style="width: 100%; padding: 16px 20px; border: 2px solid rgba(99, 102, 241, 0.15); border-radius: 14px; font-size: 16px; background: rgba(255, 255, 255, 0.95);">
                        <option value="–§–ë–û">–§–ë–û</option>
                        <option value="–§–ë–°">–§–ë–°</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn-cancel" onclick="hideAddProductModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn-save" onclick="addNewProduct()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="script.js?v=2.0"></script>
    <script>
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    registration.unregister();
                }
            });
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
        window.addEventListener('beforeunload', function() {
            localStorage.setItem('last_update', Date.now());
        });
        
        console.log('App version: 2.0 - Updated interface with product search');
    </script>
</body>
</html>
